<!doctype html><html><head><title>lypnov-exponents-caputo</title><base href="../../"><meta id="root-path" root-path="../../"><link rel="icon" sizes="96x96" href="https://publish-01.obsidian.md/access/f786db9fac45774fa4f0d8112e232d67/favicon-96x96.png"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=yes,minimum-scale=1,maximum-scale=5"><meta charset="UTF-8"><link rel="stylesheet" href="lib/styles/obsidian-styles.css"><link rel="stylesheet" href="lib/styles/theme.css"><link rel="stylesheet" href="lib/styles/plugin-styles.css"><link rel="stylesheet" href="lib/styles/snippets.css"><link rel="stylesheet" href="lib/styles/generated-styles.css"><style></style><script type="module" src="lib/scripts/graph_view.js"></script><script src="lib/scripts/graph_wasm.js"></script><script src="lib/scripts/tinycolor.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.2.4/pixi.min.js" integrity="sha512-Ch/O6kL8BqUwAfCF7Ie5SX1Hin+BJgYH4pNjRqXdTEqMsis1TUYg+j6nnI9uduPjGaj7DN4UKCZgpvoExt6dkw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lib/scripts/webpage.js"></script><script src="lib/scripts/generated.js"></script></head><body class="theme-dark mod-macos native-scrollbars is-translucent highlightr-realistic show-inline-title sidebars-always-collapsible loading"><div class="webpage-container"><div class="sidebar-left sidebar"><div class="sidebar-container"><div class="sidebar-sizer"><div class="sidebar-content-positioner"><div class="sidebar-content"><div><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="tree-container file-tree mod-nav-indicator" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">obsidian</span><button class="clickable-icon collapse-tree-button is-collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area"><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">content</span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">blog</span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="content/blog/csir-newfms-guide.html"><span class="tree-item-title">csir newfms guide</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="content/blog/index.html"><span class="tree-item-title">index</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="content/blog/practice-questions.html"><span class="tree-item-title">Practice Questions</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">notes</span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="content/notes/bifurcation.html"><span class="tree-item-title">Bifurcation</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="content/notes/index.html"><span class="tree-item-title">index</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">snippets</span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="content/snippets/beautiful-grainy-background.html"><span class="tree-item-title">beautiful-grainy-background</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="content/snippets/caputo-fabrizio-matlab.html"><span class="tree-item-title">caputo-fabrizio-matlab</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="content/snippets/comment-form.html"><span class="tree-item-title">comment-form</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="content/snippets/grammarly-cookies.html"><span class="tree-item-title">grammarly-cookies</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="content/snippets/hindi-in-latex.html"><span class="tree-item-title">hindi-in-latex</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="content/snippets/index.html"><span class="tree-item-title">index</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="content/snippets/latex-cropping-inserted-image-include-graphics.html"><span class="tree-item-title">latex-cropping-inserted-image-include-graphics</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="content/snippets/latex-fancy-box-for-theorem.html"><span class="tree-item-title">latex-fancy-box-for-theorem</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="content/snippets/latex-matrices-adjust-spacing-between-columns.html"><span class="tree-item-title">latex-matrices-adjust-spacing-between-columns</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="content/snippets/lypnov-exponents-caputo.html"><span class="tree-item-title">lypnov-exponents-caputo</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="content/snippets/mdx-to-html-easy.html"><span class="tree-item-title">mdx-to-html-easy</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="content/snippets/pros-cons-card.html"><span class="tree-item-title">pros-cons-card</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="content/snippets/python-bif.html"><span class="tree-item-title">python-bif</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="content/snippets/random-gradient-color-shadow-on-border-of-cards.html"><span class="tree-item-title">random-gradient-color-shadow-on-border-of-cards</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="content/snippets/reproduction-number.html"><span class="tree-item-title">reproduction-number</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="content/snippets/tex-html.html"><span class="tree-item-title">tex-html</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="content/snippets/track-changes-latex.html"><span class="tree-item-title">track-changes-latex</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">visuals</span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="content/visuals/flowdig.svg"><span class="tree-item-title">FlowDig</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="content/visuals/vectorsflowdig.svg"><span class="tree-item-title">VectorsFlowDig</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="content/_index.html"><span class="tree-item-title">_index</span></a></div><div class="tree-item-children"></div></div></div></div></div></div></div></div></div></div><div class="sidebar-gutter"><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div></div><div class="document-container show"><div class="markdown-preview-view markdown-rendered node-insert-event is-readable-line-width allow-fold-headings show-indentation-guide allow-fold-lists show-properties math-booster-en" tabindex="-1" style="tab-size:4"><style id="MJX-CHTML-styles">mjx-container[jax=CHTML]{line-height:0}mjx-container [space="1"]{margin-left:.111em}mjx-container [space="2"]{margin-left:.167em}mjx-container [space="3"]{margin-left:.222em}mjx-container [space="4"]{margin-left:.278em}mjx-container [space="5"]{margin-left:.333em}mjx-container [rspace="1"]{margin-right:.111em}mjx-container [rspace="2"]{margin-right:.167em}mjx-container [rspace="3"]{margin-right:.222em}mjx-container [rspace="4"]{margin-right:.278em}mjx-container [rspace="5"]{margin-right:.333em}mjx-container [size="s"]{font-size:70.7%}mjx-container [size=ss]{font-size:50%}mjx-container [size=Tn]{font-size:60%}mjx-container [size=sm]{font-size:85%}mjx-container [size=lg]{font-size:120%}mjx-container [size=Lg]{font-size:144%}mjx-container [size=LG]{font-size:173%}mjx-container [size=hg]{font-size:207%}mjx-container [size=HG]{font-size:249%}mjx-container [width=full]{width:100%}mjx-box{display:inline-block}mjx-block{display:block}mjx-itable{display:inline-table}mjx-row{display:table-row}mjx-row>*{display:table-cell}mjx-mtext{display:inline-block;text-align:left}mjx-mstyle{display:inline-block}mjx-merror{display:inline-block;color:red;background-color:#ff0}mjx-mphantom{visibility:hidden}mjx-assistive-mml{top:0;left:0;clip:rect(1px,1px,1px,1px);user-select:none;position:absolute!important;padding:1px 0 0!important;border:0!important;display:block!important;width:auto!important;overflow:hidden!important}mjx-assistive-mml[display=block]{width:100%!important}mjx-math{display:inline-block;text-align:left;line-height:0;text-indent:0;font-style:normal;font-weight:400;font-size:100%;letter-spacing:normal;border-collapse:collapse;overflow-wrap:normal;word-spacing:normal;white-space:nowrap;direction:ltr;padding:1px 0}mjx-container[jax=CHTML][display=true]{display:block;text-align:center;margin:1em 0}mjx-container[jax=CHTML][display=true][width=full]{display:flex}mjx-container[jax=CHTML][display=true] mjx-math{padding:0}mjx-container[jax=CHTML][justify=left]{text-align:left}mjx-container[jax=CHTML][justify=right]{text-align:right}mjx-mi{display:inline-block;text-align:left}mjx-c{display:inline-block}mjx-utext{display:inline-block;padding:.75em 0 .2em}mjx-msup{display:inline-block;text-align:left}mjx-texatom{display:inline-block;text-align:left}mjx-mo{display:inline-block;text-align:left}mjx-stretchy-h{display:inline-table;width:100%}mjx-stretchy-h>*{display:table-cell;width:0}mjx-stretchy-h>*>mjx-c{display:inline-block;transform:scaleX(1)}mjx-stretchy-h>*>mjx-c::before{display:inline-block;width:initial}mjx-stretchy-h>mjx-ext{overflow:clip visible;width:100%}mjx-stretchy-h>mjx-ext>mjx-c::before{transform:scaleX(500)}mjx-stretchy-h>mjx-ext>mjx-c{width:0}mjx-stretchy-h>mjx-beg>mjx-c{margin-right:-.1em}mjx-stretchy-h>mjx-end>mjx-c{margin-left:-.1em}mjx-stretchy-v{display:inline-block}mjx-stretchy-v>*{display:block}mjx-stretchy-v>mjx-beg{height:0}mjx-stretchy-v>mjx-end>mjx-c{display:block}mjx-stretchy-v>*>mjx-c{transform:scaleY(1);transform-origin:left center;overflow:hidden}mjx-stretchy-v>mjx-ext{display:block;height:100%;box-sizing:border-box;border:0 solid transparent;overflow:visible clip}mjx-stretchy-v>mjx-ext>mjx-c::before{width:initial;box-sizing:border-box}mjx-stretchy-v>mjx-ext>mjx-c{transform:scaleY(500) translateY(.075em);overflow:visible}mjx-mark{display:inline-block;height:0}mjx-mn{display:inline-block;text-align:left}mjx-msub{display:inline-block;text-align:left}mjx-mover{display:inline-block;text-align:left}mjx-mover:not([limits=false]){padding-top:.1em}mjx-mover:not([limits=false])>*{display:block;text-align:left}mjx-c::before{display:block;width:0}.MJX-TEX{font-family:MJXZERO,MJXTEX}.TEX-B{font-family:MJXZERO,MJXTEX-B}.TEX-I{font-family:MJXZERO,MJXTEX-I}.TEX-MI{font-family:MJXZERO,MJXTEX-MI}.TEX-BI{font-family:MJXZERO,MJXTEX-BI}.TEX-S1{font-family:MJXZERO,MJXTEX-S1}.TEX-S2{font-family:MJXZERO,MJXTEX-S2}.TEX-S3{font-family:MJXZERO,MJXTEX-S3}.TEX-S4{font-family:MJXZERO,MJXTEX-S4}.TEX-A{font-family:MJXZERO,MJXTEX-A}.TEX-C{font-family:MJXZERO,MJXTEX-C}.TEX-CB{font-family:MJXZERO,MJXTEX-CB}.TEX-FR{font-family:MJXZERO,MJXTEX-FR}.TEX-FRB{font-family:MJXZERO,MJXTEX-FRB}.TEX-SS{font-family:MJXZERO,MJXTEX-SS}.TEX-SSB{font-family:MJXZERO,MJXTEX-SSB}.TEX-SSI{font-family:MJXZERO,MJXTEX-SSI}.TEX-SC{font-family:MJXZERO,MJXTEX-SC}.TEX-T{font-family:MJXZERO,MJXTEX-T}.TEX-V{font-family:MJXZERO,MJXTEX-V}.TEX-VB{font-family:MJXZERO,MJXTEX-VB}mjx-stretchy-h mjx-c,mjx-stretchy-v mjx-c{font-family:MJXZERO,MJXTEX-S1,MJXTEX-S4,MJXTEX,MJXTEX-A!important}@font-face{font-family:MJXZERO;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Zero.woff") format("woff")}@font-face{font-family:MJXTEX;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Main-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-B;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Main-Bold.woff") format("woff")}@font-face{font-family:MJXTEX-I;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Math-Italic.woff") format("woff")}@font-face{font-family:MJXTEX-MI;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Main-Italic.woff") format("woff")}@font-face{font-family:MJXTEX-BI;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Math-BoldItalic.woff") format("woff")}@font-face{font-family:MJXTEX-S1;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Size1-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-S2;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Size2-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-S3;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Size3-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-S4;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Size4-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-A;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_AMS-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-C;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-CB;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Bold.woff") format("woff")}@font-face{font-family:MJXTEX-FR;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Fraktur-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-FRB;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Fraktur-Bold.woff") format("woff")}@font-face{font-family:MJXTEX-SS;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_SansSerif-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-SSB;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_SansSerif-Bold.woff") format("woff")}@font-face{font-family:MJXTEX-SSI;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_SansSerif-Italic.woff") format("woff")}@font-face{font-family:MJXTEX-SC;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Script-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-T;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Typewriter-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-V;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Vector-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-VB;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Vector-Bold.woff") format("woff")}mjx-c.mjx-c1D462.TEX-I::before{padding:.442em .572em .011em 0;content:"u"}mjx-c.mjx-c1D434.TEX-I::before{padding:.716em .75em 0 0;content:"A"}mjx-c.mjx-c1D463.TEX-I::before{padding:.443em .485em .011em 0;content:"v"}mjx-c.mjx-c1D447.TEX-I::before{padding:.677em .704em 0 0;content:"T"}mjx-c.mjx-c1D719.TEX-I::before{padding:.694em .596em .205em 0;content:"ϕ"}mjx-c.mjx-c28::before{padding:.75em .389em .25em 0;content:"("}mjx-c.mjx-c2C::before{padding:.121em .278em .194em 0;content:","}mjx-c.mjx-c29::before{padding:.75em .389em .25em 0;content:")"}mjx-c.mjx-c3D::before{padding:.583em .778em .082em 0;content:"="}mjx-c.mjx-c33::before{padding:.665em .5em .022em 0;content:"3"}mjx-c.mjx-c1D465.TEX-I::before{padding:.442em .572em .011em 0;content:"x"}mjx-c.mjx-c31::before{padding:.666em .5em 0 0;content:"1"}mjx-c.mjx-c1D466.TEX-I::before{padding:.442em .49em .205em 0;content:"y"}mjx-c.mjx-c2212::before{padding:.583em .778em .082em 0;content:"−"}mjx-c.mjx-c32::before{padding:.666em .5em 0 0;content:"2"}mjx-c.mjx-c2B::before{padding:.583em .778em .082em 0;content:"+"}mjx-c.mjx-c35::before{padding:.666em .5em .022em 0;content:"5"}mjx-c.mjx-c37::before{padding:.676em .5em .022em 0;content:"7"}mjx-c.mjx-c38::before{padding:.666em .5em .022em 0;content:"8"}mjx-c.mjx-c34::before{padding:.677em .5em 0 0;content:"4"}mjx-c.mjx-c36::before{padding:.666em .5em .022em 0;content:"6"}mjx-c.mjx-c1D446.TEX-I::before{padding:.705em .645em .022em 0;content:"S"}mjx-c.mjx-c1D435.TEX-I::before{padding:.683em .759em 0 0;content:"B"}mjx-c.mjx-c2DC.TEX-S1::before{padding:.722em .556em 0 0;content:"˜"}mjx-c.mjx-c1D443.TEX-I::before{padding:.683em .751em 0 0;content:"P"}mjx-c.mjx-c2E::before{padding:.12em .278em 0 0;content:"."}mjx-c.mjx-c7B::before{padding:.75em .5em .25em 0;content:"{"}mjx-c.mjx-c7D::before{padding:.75em .5em .25em 0;content:"}"}mjx-c.mjx-cA0::before{padding:0 .25em 0 0;content:" "}mjx-c.mjx-c61::before{padding:.448em .5em .011em 0;content:"a"}mjx-c.mjx-c6E::before{padding:.442em .556em 0 0;content:"n"}mjx-c.mjx-c64::before{padding:.694em .556em .011em 0;content:"d"}mjx-c.mjx-c30::before{padding:.666em .5em .022em 0;content:"0"}mjx-c.mjx-c1D45B.TEX-I::before{padding:.442em .6em .011em 0;content:"n"}mjx-c.mjx-c1D449.TEX-I::before{padding:.683em .769em .022em 0;content:"V"}mjx-c.mjx-c1D439.TEX-I::before{padding:.68em .749em 0 0;content:"F"}mjx-c.mjx-c1D456.TEX-I::before{padding:.661em .345em .011em 0;content:"i"}mjx-c.mjx-c1D457.TEX-I::before{padding:.661em .412em .204em 0;content:"j"}mjx-c.mjx-c1D453.TEX-I::before{padding:.705em .55em .205em 0;content:"f"}mjx-c.mjx-c66::before{padding:.705em .372em 0 0;content:"f"}mjx-c.mjx-c6F::before{padding:.448em .5em .01em 0;content:"o"}mjx-c.mjx-c72::before{padding:.442em .392em 0 0;content:"r"}mjx-c.mjx-c20::before{padding:0 .25em 0 0;content:" "}mjx-c.mjx-c6C::before{padding:.694em .278em 0 0;content:"l"}mjx-c.mjx-c2208::before{padding:.54em .667em .04em 0;content:"∈"}mjx-c.mjx-c2223::before{padding:.75em .278em .249em 0;content:"∣"}mjx-c.mjx-c22EF::before{padding:.31em 1.172em 0 0;content:"⋯"}mjx-c.mjx-c2217::before{padding:.465em .5em 0 0;content:"∗"}</style><div class="markdown-preview-sizer markdown-preview-section" style="min-height:2179px"><div class="markdown-preview-pusher" style="width:1px;height:.1px;margin-bottom:0"></div><div class="mod-header"><div class="inline-title" data-heading="lypnov-exponents-caputo" id="lypnov-exponents-caputo" style="display:block">lypnov-exponents-caputo</div></div><div><pre class="frontmatter language-yaml" tabindex="0" style="display:none"><code class="language-yaml is-loaded"><span class="token key atrule">title</span><span class="token punctuation">:</span> Lyapunov exponents matlab
<span class="token key atrule">logo</span><span class="token punctuation">:</span> matlab.png
<span class="token key atrule">description</span><span class="token punctuation">:</span> Matlab code for plotting Lyapunov exponents with fractional<span class="token punctuation">-</span>order system using Caputo derivatives and Predictor<span class="token punctuation">-</span>corrector numerical method.
<span class="token key atrule">updated</span><span class="token punctuation">:</span> 2023<span class="token punctuation">-</span>10<span class="token punctuation">-</span>03T17<span class="token punctuation">:</span><span class="token number">25</span></code><button class="copy-code-button">Copy</button></pre></div><div><pre class="language-matlab" tabindex="0"><code class="language-matlab is-loaded"><span class="token keyword">function</span> <span class="token punctuation">[</span>t<span class="token punctuation">,</span> y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">fde12</span><span class="token punctuation">(</span>alpha<span class="token punctuation">,</span>fdefun<span class="token punctuation">,</span>t0<span class="token punctuation">,</span>tfinal<span class="token punctuation">,</span>y0<span class="token punctuation">,</span>h<span class="token punctuation">,</span>param<span class="token punctuation">,</span>mu<span class="token punctuation">,</span>mu_tol<span class="token punctuation">)</span>
<span class="token comment">%FDE12  Solves an initial value problem for a non-linear differential</span>
<span class="token comment">%       equation of fractional order (FDE). The code implements the</span>
<span class="token comment">%       predictor-corrector PECE method of Adams-Bashforth-Moulton type</span>
<span class="token comment">%       described in [1].</span>
%
<span class="token comment">%   [T,Y] = FDE12(ALPHA,FDEFUN,T0,TFINAL,Y0,h) integrates the initial value</span>
<span class="token comment">%   problem for the FDE, or the system of FDEs, of order ALPHA &gt; 0</span>
<span class="token comment">%      D^ALPHA Y(t) = FDEFUN(T,Y(T))</span>
<span class="token comment">%      Y^(k)(T0) = Y0(:,k+1), k=0,...,m-1</span>
<span class="token comment">%   where m is the smallest integer grater than ALPHA and D^ALPHA is the</span>
<span class="token comment">%   fractional derivative according to the Caputo's definition. FDEFUN is a</span>
<span class="token comment">%   function handle corresponding to the vector field of the FDE and for a</span>
<span class="token comment">%   scalar T and a vector Y, FDEFUN(T,Y) must return a column vector. The</span>
<span class="token comment">%   set of initial conditions Y0 is a matrix with a number of rows equal to</span>
<span class="token comment">%   the size of the problem (hence equal to the number of rows of the</span>
<span class="token comment">%   output of FDEFUN) and a number of columns depending on ALPHA and given</span>
<span class="token comment">%   by m. The step-size H&gt;0 is assumed constant throughout the integration.</span>
%
<span class="token comment">%   [T,Y] = FDE12(ALPHA,FDEFUN,T0,TFINAL,Y0,H,PARAM) solves as above with</span>
<span class="token comment">%   the additional set of parameters for the FDEFUN as FDEFUN(T,Y,PARAM).</span>
%
<span class="token comment">%   [T,Y] = FDE12(ALPHA,FDEFUN,T0,TFINAL,Y0,H,PARAM,MU) solves the FDE with</span>
<span class="token comment">%   the selected number MU of multiple corrector iterations. The following</span>
<span class="token comment">%   values for MU are admissible:</span>
<span class="token comment">%   MU = 0 : the corrector is not evaluated and the solution is provided</span>
<span class="token comment">%   just by the predictor method (the first order rectangular rule);</span>
<span class="token comment">%   MU &gt; 0 : the corrector is evaluated by the selected number MU of times;</span>
<span class="token comment">%   the classical PECE method is obtained for MU=1;</span>
<span class="token comment">%   MU = Inf : the corrector is evaluated for a certain number of times</span>
<span class="token comment">%   until convergence of the iterations is reached (for convergence the</span>
<span class="token comment">%   difference between two consecutive iterates is tested).</span>
<span class="token comment">%   The defalut value for MU is 1</span>
%
<span class="token comment">%   [T,Y] = FDE12(ALPHA,FDEFUN,T0,TFINAL,Y0,H,PARAM,MU,MU_TOL) allows to</span>
<span class="token comment">%   specify the tolerance for testing convergence when MU = Inf. If not</span>
<span class="token comment">%   specified, the default value MU_TOL = 1.E-6 is used.</span>
%
<span class="token comment">%   FDE12 is an implementation of the predictor-corrector method of</span>
<span class="token comment">%   Adams-Bashforth-Moulton studied in [1]. Convergence and accuracy of</span>
<span class="token comment">%   the method are studied in [2]. The implementation with multiple</span>
<span class="token comment">%   corrector iterations has been proposed and discussed for multiterm FDEs</span>
<span class="token comment">%   in [3]. In this implementation the discrete convolutions are evaluated</span>
<span class="token comment">%   by means of the FFT algorithm described in [4] allowing to keep the</span>
<span class="token comment">%   computational cost proportional to N*log(N)^2 instead of N^2 as in the</span>
<span class="token comment">%   classical implementation; N is the number of time-point in which the</span>
<span class="token comment">%   solution is evaluated, i.e. N = (TFINAL-T)/H. The stability properties</span>
<span class="token comment">%   of the method implemented by FDE12 have been studied in [5].</span>
%
<span class="token comment">%   [1] K. Diethelm, A.D. Freed, The Frac PECE subroutine for the numerical</span>
<span class="token comment">%   solution of differential equations of fractional order, in: S. Heinzel,</span>
<span class="token comment">%   T. Plesser (Eds.), Forschung und Wissenschaftliches Rechnen 1998,</span>
<span class="token comment">%   Gessellschaft fur Wissenschaftliche Datenverarbeitung, Gottingen, 1999,</span>
<span class="token comment">%   pp. 57-71.</span>
%
<span class="token comment">%   [2] K. Diethelm, N.J. Ford, A.D. Freed, Detailed error analysis for a</span>
<span class="token comment">%   fractional Adams method, Numer. Algorithms 36 (1) (2004) 31-52.</span>
%
<span class="token comment">%   [3] K. Diethelm, Efficient solution of multi-term fractional</span>
<span class="token comment">%   differential equations using P(EC)mE methods, Computing 71 (2003), pp.</span>
<span class="token comment">%   305-319.</span>
%
<span class="token comment">%   [4] E. Hairer, C. Lubich, M. Schlichte, Fast numerical solution of</span>
<span class="token comment">%   nonlinear Volterra convolution equations, SIAM J. Sci. Statist. Comput.</span>
<span class="token comment">%   6 (3) (1985) 532-541.</span>
%
<span class="token comment">%   [5] R. Garrappa, On linear stability of predictor-corrector algorithms</span>
<span class="token comment">%   for fractional differential equations, Internat. J. Comput. Math. 87</span>
<span class="token comment">%   (10) (2010) 2281-2290.</span>
%
<span class="token comment">%   Copyright (c) 2011-2012, Roberto Garrappa, University of Bari, Italy</span>
<span class="token comment">%   garrappa at dm dot uniba dot it</span>
<span class="token comment">%   Revision: 1.2 - Date: July, 6 2012</span>

<span class="token comment">% Check inputs</span>
<span class="token keyword">if</span> nargin <span class="token operator">&lt;</span> <span class="token number">9</span>
    mu_tol <span class="token operator">=</span> <span class="token number">1.0e-6</span> <span class="token punctuation">;</span>
    <span class="token keyword">if</span> nargin <span class="token operator">&lt;</span> <span class="token number">8</span>
        mu <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">;</span>
        <span class="token keyword">if</span> nargin <span class="token operator">&lt;</span> <span class="token number">7</span>
            param <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">;</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token comment">% Check order of the FDE</span>
<span class="token keyword">if</span> alpha <span class="token operator">&lt;=</span> <span class="token number">0</span>
    <span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'MATLAB:fde12:NegativeOrder'</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
        <span class="token punctuation">[</span><span class="token string">'The order ALPHA of the FDE must be positive. The value '</span> <span class="token punctuation">...</span>
         <span class="token string">'ALPHA = %f can not be accepted. See FDE12.'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> alpha<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>

<span class="token comment">% Check the step--size of the method</span>
<span class="token keyword">if</span> h <span class="token operator">&lt;=</span> <span class="token number">0</span>
    <span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'MATLAB:fde12:NegativeStepSize'</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
        <span class="token punctuation">[</span><span class="token string">'The step-size H for the method must be positive. The value '</span> <span class="token punctuation">...</span>
         <span class="token string">'H = %e can not be accepted. See FDE12.'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>

<span class="token comment">% Structure for storing initial conditions</span>
ic<span class="token punctuation">.</span>t0 <span class="token operator">=</span> t0 <span class="token punctuation">;</span>
ic<span class="token punctuation">.</span>y0 <span class="token operator">=</span> y0 <span class="token punctuation">;</span>
ic<span class="token punctuation">.</span>m_alpha <span class="token operator">=</span> <span class="token function">ceil</span><span class="token punctuation">(</span>alpha<span class="token punctuation">)</span> <span class="token punctuation">;</span>
ic<span class="token punctuation">.</span>m_alpha_factorial <span class="token operator">=</span> <span class="token function">factorial</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span>ic<span class="token punctuation">.</span>m_alpha<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>

<span class="token comment">% Structure for storing information on the problem</span>
Probl<span class="token punctuation">.</span>ic <span class="token operator">=</span> ic <span class="token punctuation">;</span>
Probl<span class="token punctuation">.</span>fdefun <span class="token operator">=</span> fdefun <span class="token punctuation">;</span>
Probl<span class="token punctuation">.</span>problem_size <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span>y0<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
Probl<span class="token punctuation">.</span>param <span class="token operator">=</span> param <span class="token punctuation">;</span>

<span class="token comment">% Check number of initial conditions</span>
<span class="token keyword">if</span> <span class="token function">size</span><span class="token punctuation">(</span>y0<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> ic<span class="token punctuation">.</span>m_alpha
    <span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'MATLAB:fde12:NotEnoughInputs'</span><span class="token punctuation">,</span> <span class="token punctuation">...</span>
        <span class="token punctuation">[</span><span class="token string">'A not sufficient number of assigned initial conditions. '</span> <span class="token punctuation">...</span>
        <span class="token string">'Order ALPHA = %f requires %d initial conditions. See FDE12.'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">...</span>
        alpha<span class="token punctuation">,</span>ic<span class="token punctuation">.</span>m_alpha<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>

<span class="token comment">% Check compatibility size of the problem with size of the vector field</span>
f_temp <span class="token operator">=</span> <span class="token function">f_vectorfield</span><span class="token punctuation">(</span>t0<span class="token punctuation">,</span><span class="token function">y0</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Probl<span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token keyword">if</span> Probl<span class="token punctuation">.</span>problem_size <span class="token operator">~=</span> <span class="token function">size</span><span class="token punctuation">(</span>f_temp<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'MATLAB:fde12:SizeNotCompatible'</span><span class="token punctuation">,</span> <span class="token punctuation">...</span>
        <span class="token punctuation">[</span><span class="token string">'Size %d of the problem as obtained from initial conditions '</span> <span class="token punctuation">...</span>
         <span class="token string">'(i.e. the number of rows of Y0) not compatible with the '</span> <span class="token punctuation">...</span>
         <span class="token string">'size %d of the output of the vector field FDEFUN. '</span> <span class="token punctuation">...</span>
         <span class="token string">'See FDE12.'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Probl<span class="token punctuation">.</span>problem_size<span class="token punctuation">,</span><span class="token function">size</span><span class="token punctuation">(</span>f_temp<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>

<span class="token comment">% Number of points in which to evaluate weights and solution</span>
r <span class="token operator">=</span> <span class="token number">16</span> <span class="token punctuation">;</span>
N <span class="token operator">=</span> <span class="token function">ceil</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tfinal<span class="token operator">-</span>t0<span class="token punctuation">)</span><span class="token operator">/</span>h<span class="token punctuation">)</span> <span class="token punctuation">;</span>
Nr <span class="token operator">=</span> <span class="token function">ceil</span><span class="token punctuation">(</span><span class="token punctuation">(</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span>r<span class="token punctuation">)</span><span class="token operator">*</span>r <span class="token punctuation">;</span>
Q <span class="token operator">=</span> <span class="token function">ceil</span><span class="token punctuation">(</span><span class="token function">log2</span><span class="token punctuation">(</span>Nr<span class="token operator">/</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">;</span>
NNr <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">^</span><span class="token punctuation">(</span>Q<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>r <span class="token punctuation">;</span>

<span class="token comment">% Preallocation of some variables</span>
y <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>Probl<span class="token punctuation">.</span>problem_size<span class="token punctuation">,</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
fy <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>Probl<span class="token punctuation">.</span>problem_size<span class="token punctuation">,</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
zn_pred <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>Probl<span class="token punctuation">.</span>problem_size<span class="token punctuation">,</span>NNr<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token keyword">if</span> mu <span class="token operator">&gt;</span> <span class="token number">0</span>
    zn_corr <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>Probl<span class="token punctuation">.</span>problem_size<span class="token punctuation">,</span>NNr<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token keyword">else</span>
    zn_corr <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span>
<span class="token keyword">end</span>

<span class="token comment">% Evaluation of coefficients of the PECE method</span>
nvett <span class="token operator">=</span> <span class="token number">0</span> <span class="token operator">:</span> NNr<span class="token operator">+</span><span class="token number">1</span> <span class="token punctuation">;</span>
nalpha <span class="token operator">=</span> nvett<span class="token operator">.^</span>alpha <span class="token punctuation">;</span>
nalpha1 <span class="token operator">=</span> nalpha<span class="token operator">.*</span>nvett <span class="token punctuation">;</span>
PC<span class="token punctuation">.</span>bn <span class="token operator">=</span> <span class="token function">nalpha</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">nalpha</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
PC<span class="token punctuation">.</span>an <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token number">1</span> <span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token function">nalpha1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token operator">*</span><span class="token function">nalpha1</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">nalpha1</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">]</span> <span class="token punctuation">;</span>
PC<span class="token punctuation">.</span>a0 <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token number">0</span> <span class="token punctuation">,</span> <span class="token function">nalpha1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">nalpha</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">.*</span><span class="token punctuation">(</span><span class="token function">nvett</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-</span>alpha<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token punctuation">;</span>
PC<span class="token punctuation">.</span>halpha1 <span class="token operator">=</span> h<span class="token operator">^</span>alpha<span class="token operator">/</span><span class="token function">gamma</span><span class="token punctuation">(</span>alpha<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
PC<span class="token punctuation">.</span>halpha2 <span class="token operator">=</span> h<span class="token operator">^</span>alpha<span class="token operator">/</span><span class="token function">gamma</span><span class="token punctuation">(</span>alpha<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
PC<span class="token punctuation">.</span>mu <span class="token operator">=</span> mu <span class="token punctuation">;</span> PC<span class="token punctuation">.</span>mu_tol <span class="token operator">=</span> mu_tol <span class="token punctuation">;</span>

<span class="token comment">% Initializing solution and proces of computation</span>
t <span class="token operator">=</span> t0 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">:</span> N<span class="token punctuation">)</span><span class="token operator">*</span>h <span class="token punctuation">;</span>
<span class="token function">y</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">y0</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token function">fy</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> f_temp <span class="token punctuation">;</span>
<span class="token punctuation">[</span>y<span class="token punctuation">,</span> fy<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">Triangolo</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> r<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> t<span class="token punctuation">,</span> y<span class="token punctuation">,</span> fy<span class="token punctuation">,</span> zn_pred<span class="token punctuation">,</span> zn_corr<span class="token punctuation">,</span> N<span class="token punctuation">,</span> PC<span class="token punctuation">,</span> Probl <span class="token punctuation">)</span> <span class="token punctuation">;</span>

<span class="token comment">% Main process of computation by means of the FFT algorithm</span>
ff <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">2</span> <span class="token punctuation">]</span> <span class="token punctuation">;</span> nx0 <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> ny0 <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span>
<span class="token keyword">for</span> q <span class="token operator">=</span> <span class="token number">0</span> <span class="token operator">:</span> Q
    L <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">^</span>q <span class="token punctuation">;</span>
    <span class="token punctuation">[</span>y<span class="token punctuation">,</span> fy<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">DisegnaBlocchi</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> ff<span class="token punctuation">,</span> r<span class="token punctuation">,</span> Nr<span class="token punctuation">,</span> nx0<span class="token operator">+</span>L<span class="token operator">*</span>r<span class="token punctuation">,</span> ny0<span class="token punctuation">,</span> t<span class="token punctuation">,</span> y<span class="token punctuation">,</span> fy<span class="token punctuation">,</span> <span class="token punctuation">...</span>
                             zn_pred<span class="token punctuation">,</span> zn_corr<span class="token punctuation">,</span> N<span class="token punctuation">,</span> PC<span class="token punctuation">,</span> Probl <span class="token punctuation">)</span> <span class="token punctuation">;</span>
    ff <span class="token operator">=</span> <span class="token punctuation">[</span>ff ff<span class="token punctuation">]</span>  <span class="token punctuation">;</span> <span class="token function">ff</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token operator">*</span>L <span class="token punctuation">;</span>
<span class="token keyword">end</span>

<span class="token comment">% Evaluation solution in TFINAL when TFINAL is not in the mesh</span>
<span class="token keyword">if</span> tfinal <span class="token operator">&lt;</span> <span class="token function">t</span><span class="token punctuation">(</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    c <span class="token operator">=</span> <span class="token punctuation">(</span>tfinal <span class="token operator">-</span> <span class="token function">t</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>h <span class="token punctuation">;</span>
    <span class="token function">t</span><span class="token punctuation">(</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> tfinal <span class="token punctuation">;</span>
    <span class="token function">y</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>c<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span>N<span class="token punctuation">)</span> <span class="token operator">+</span> c<span class="token operator">*</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token keyword">end</span>
t <span class="token operator">=</span> <span class="token function">t</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">;</span> y <span class="token operator">=</span> <span class="token function">y</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>

<span class="token keyword">end</span>


<span class="token comment">% =========================================================================</span>
<span class="token comment">% =========================================================================</span>
<span class="token comment">% r : dimension of the basic square or triangle</span>
<span class="token comment">% L : factor of resizing of the squares</span>
<span class="token keyword">function</span> <span class="token punctuation">[</span>y<span class="token punctuation">,</span> fy<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">DisegnaBlocchi</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> ff<span class="token punctuation">,</span> r<span class="token punctuation">,</span> Nr<span class="token punctuation">,</span> nx0<span class="token punctuation">,</span> ny0<span class="token punctuation">,</span> t<span class="token punctuation">,</span> y<span class="token punctuation">,</span> fy<span class="token punctuation">,</span> <span class="token punctuation">...</span>
                                  zn_pred<span class="token punctuation">,</span> zn_corr<span class="token punctuation">,</span> N <span class="token punctuation">,</span> PC<span class="token punctuation">,</span> Probl<span class="token punctuation">)</span>

nxi <span class="token operator">=</span> nx0 <span class="token punctuation">;</span> nxf <span class="token operator">=</span> nx0 <span class="token operator">+</span> L<span class="token operator">*</span>r <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">;</span>
nyi <span class="token operator">=</span> ny0 <span class="token punctuation">;</span> nyf <span class="token operator">=</span> ny0 <span class="token operator">+</span> L<span class="token operator">*</span>r <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">;</span>
is <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">;</span>
<span class="token function">s_nxi</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span> <span class="token operator">=</span> nxi <span class="token punctuation">;</span> <span class="token function">s_nxf</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span> <span class="token operator">=</span> nxf <span class="token punctuation">;</span> <span class="token function">s_nyi</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span> <span class="token operator">=</span> nyi <span class="token punctuation">;</span> <span class="token function">s_nyf</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span> <span class="token operator">=</span> nyf <span class="token punctuation">;</span>

i_triangolo <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> stop <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token operator">~</span>stop

    stop <span class="token operator">=</span> nxi<span class="token operator">+</span>r<span class="token operator">-</span><span class="token number">1</span> <span class="token operator">==</span> nx0<span class="token operator">+</span>L<span class="token operator">*</span>r<span class="token operator">-</span><span class="token number">1</span> <span class="token operator">|</span> <span class="token punctuation">(</span>nxi<span class="token operator">+</span>r<span class="token operator">-</span><span class="token number">1</span><span class="token operator">&gt;=</span>Nr<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">;</span> <span class="token comment">% Ci si ferma quando il triangolo attuale finisce alla fine del quadrato</span>

    <span class="token punctuation">[</span>zn_pred<span class="token punctuation">,</span> zn_corr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">Quadrato</span><span class="token punctuation">(</span>nxi<span class="token punctuation">,</span> nxf<span class="token punctuation">,</span> nyi<span class="token punctuation">,</span> nyf<span class="token punctuation">,</span> fy<span class="token punctuation">,</span> zn_pred<span class="token punctuation">,</span> zn_corr<span class="token punctuation">,</span> PC<span class="token punctuation">,</span> Probl<span class="token punctuation">)</span> <span class="token punctuation">;</span>

    <span class="token punctuation">[</span>y<span class="token punctuation">,</span> fy<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">Triangolo</span><span class="token punctuation">(</span>nxi<span class="token punctuation">,</span> nxi<span class="token operator">+</span>r<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> t<span class="token punctuation">,</span> y<span class="token punctuation">,</span> fy<span class="token punctuation">,</span> zn_pred<span class="token punctuation">,</span> zn_corr<span class="token punctuation">,</span> N<span class="token punctuation">,</span> PC<span class="token punctuation">,</span> Probl<span class="token punctuation">)</span> <span class="token punctuation">;</span>
    i_triangolo <span class="token operator">=</span> i_triangolo <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token operator">~</span>stop
        <span class="token keyword">if</span> nxi<span class="token operator">+</span>r<span class="token operator">-</span><span class="token number">1</span> <span class="token operator">==</span> nxf   <span class="token comment">% Il triangolo finisce dove finisce il quadrato -&gt; si scende di livello</span>
            i_Delta <span class="token operator">=</span> <span class="token function">ff</span><span class="token punctuation">(</span>i_triangolo<span class="token punctuation">)</span> <span class="token punctuation">;</span>
            Delta <span class="token operator">=</span> i_Delta<span class="token operator">*</span>r <span class="token punctuation">;</span>
            nxi <span class="token operator">=</span> <span class="token function">s_nxf</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span> <span class="token punctuation">;</span> nxf <span class="token operator">=</span> <span class="token function">s_nxf</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span>  <span class="token operator">+</span> Delta <span class="token punctuation">;</span>
            nyi <span class="token operator">=</span> <span class="token function">s_nxf</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span> <span class="token operator">-</span> Delta <span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> nyf <span class="token operator">=</span> <span class="token function">s_nxf</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span>  <span class="token punctuation">;</span>
            <span class="token function">s_nxi</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span> <span class="token operator">=</span> nxi <span class="token punctuation">;</span> <span class="token function">s_nxf</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span> <span class="token operator">=</span> nxf <span class="token punctuation">;</span> <span class="token function">s_nyi</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span> <span class="token operator">=</span> nyi <span class="token punctuation">;</span> <span class="token function">s_nyf</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span> <span class="token operator">=</span> nyf <span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token comment">% Il triangolo finisce prima del quadrato -&gt; si fa un quadrato accanto</span>
            nxi <span class="token operator">=</span> nxi <span class="token operator">+</span> r <span class="token punctuation">;</span> nxf <span class="token operator">=</span> nxi <span class="token operator">+</span> r <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">;</span> nyi <span class="token operator">=</span> nyf <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">;</span> nyf <span class="token operator">=</span> nyf <span class="token operator">+</span> r  <span class="token punctuation">;</span>
            is <span class="token operator">=</span> is <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">;</span>
            <span class="token function">s_nxi</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span> <span class="token operator">=</span> nxi <span class="token punctuation">;</span> <span class="token function">s_nxf</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span> <span class="token operator">=</span> nxf <span class="token punctuation">;</span> <span class="token function">s_nyi</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span> <span class="token operator">=</span> nyi <span class="token punctuation">;</span> <span class="token function">s_nyf</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span> <span class="token operator">=</span> nyf <span class="token punctuation">;</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>

<span class="token keyword">end</span>

<span class="token keyword">end</span>

<span class="token comment">% =========================================================================</span>
<span class="token comment">% =========================================================================</span>
<span class="token keyword">function</span> <span class="token punctuation">[</span>zn_pred<span class="token punctuation">,</span> zn_corr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">Quadrato</span><span class="token punctuation">(</span>nxi<span class="token punctuation">,</span> nxf<span class="token punctuation">,</span> nyi<span class="token punctuation">,</span> nyf<span class="token punctuation">,</span> fy<span class="token punctuation">,</span> zn_pred<span class="token punctuation">,</span> zn_corr<span class="token punctuation">,</span> PC<span class="token punctuation">,</span> Probl<span class="token punctuation">)</span>

coef_beg <span class="token operator">=</span> nxi<span class="token operator">-</span>nyf <span class="token punctuation">;</span> coef_end <span class="token operator">=</span> nxf<span class="token operator">-</span>nyi<span class="token operator">+</span><span class="token number">1</span> <span class="token punctuation">;</span>
funz_beg <span class="token operator">=</span> nyi<span class="token operator">+</span><span class="token number">1</span> <span class="token punctuation">;</span> funz_end <span class="token operator">=</span> nyf<span class="token operator">+</span><span class="token number">1</span> <span class="token punctuation">;</span>

<span class="token comment">% Evaluation convolution segment for the predictor</span>
vett_coef <span class="token operator">=</span> PC<span class="token punctuation">.</span><span class="token function">bn</span><span class="token punctuation">(</span>coef_beg<span class="token operator">:</span>coef_end<span class="token punctuation">)</span> <span class="token punctuation">;</span>
vett_funz <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">fy</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span>funz_beg<span class="token operator">:</span>funz_end<span class="token punctuation">)</span> <span class="token punctuation">,</span> <span class="token function">zeros</span><span class="token punctuation">(</span>Probl<span class="token punctuation">.</span>problem_size<span class="token punctuation">,</span>funz_end<span class="token operator">-</span>funz_beg<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">]</span> <span class="token punctuation">;</span>
zzn_pred <span class="token operator">=</span> <span class="token function">real</span><span class="token punctuation">(</span><span class="token function">FastConv</span><span class="token punctuation">(</span>vett_coef<span class="token punctuation">,</span>vett_funz<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token function">zn_pred</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span>nxi<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span>nxf<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">zn_pred</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span>nxi<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span>nxf<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">zzn_pred</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span>nxf<span class="token operator">-</span>nyf<span class="token operator">+</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>

<span class="token comment">% Evaluation convolution segment for the corrector</span>
<span class="token keyword">if</span> PC<span class="token punctuation">.</span>mu <span class="token operator">&gt;</span> <span class="token number">0</span>
    vett_coef <span class="token operator">=</span> PC<span class="token punctuation">.</span><span class="token function">an</span><span class="token punctuation">(</span>coef_beg<span class="token operator">:</span>coef_end<span class="token punctuation">)</span> <span class="token punctuation">;</span>
    <span class="token keyword">if</span> nyi <span class="token operator">==</span> <span class="token number">0</span> <span class="token comment">% Evaluation of the lowest square</span>
        vett_funz <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">zeros</span><span class="token punctuation">(</span>Probl<span class="token punctuation">.</span>problem_size<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">,</span> <span class="token function">fy</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span>funz_beg<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span>funz_end<span class="token punctuation">)</span> <span class="token punctuation">,</span> <span class="token function">zeros</span><span class="token punctuation">(</span>Probl<span class="token punctuation">.</span>problem_size<span class="token punctuation">,</span>funz_end<span class="token operator">-</span>funz_beg<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">]</span> <span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token comment">% Evaluation of any square but not the lowest</span>
        vett_funz <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token function">fy</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span>funz_beg<span class="token operator">:</span>funz_end<span class="token punctuation">)</span> <span class="token punctuation">,</span> <span class="token function">zeros</span><span class="token punctuation">(</span>Probl<span class="token punctuation">.</span>problem_size<span class="token punctuation">,</span>funz_end<span class="token operator">-</span>funz_beg<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">]</span> <span class="token punctuation">;</span>
    <span class="token keyword">end</span>
    zzn_corr <span class="token operator">=</span> <span class="token function">real</span><span class="token punctuation">(</span><span class="token function">FastConv</span><span class="token punctuation">(</span>vett_coef<span class="token punctuation">,</span>vett_funz<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
    <span class="token function">zn_corr</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span>nxi<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span>nxf<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">zn_corr</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span>nxi<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span>nxf<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">zzn_corr</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span>nxf<span class="token operator">-</span>nyf<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token keyword">else</span>
    zn_corr <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span>
<span class="token keyword">end</span>

<span class="token keyword">end</span>



<span class="token comment">% =========================================================================</span>
<span class="token comment">% =========================================================================</span>
<span class="token keyword">function</span> <span class="token punctuation">[</span>y<span class="token punctuation">,</span> fy<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">Triangolo</span><span class="token punctuation">(</span>nxi<span class="token punctuation">,</span> nxf<span class="token punctuation">,</span> t<span class="token punctuation">,</span> y<span class="token punctuation">,</span> fy<span class="token punctuation">,</span> zn_pred<span class="token punctuation">,</span> zn_corr<span class="token punctuation">,</span> N<span class="token punctuation">,</span> PC<span class="token punctuation">,</span> Probl<span class="token punctuation">)</span>

<span class="token keyword">for</span> n <span class="token operator">=</span> nxi <span class="token operator">:</span> <span class="token function">min</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span>nxf<span class="token punctuation">)</span>

    <span class="token comment">% Evaluation of the predictor</span>
    Phi <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>Probl<span class="token punctuation">.</span>problem_size<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
    <span class="token keyword">if</span> nxi <span class="token operator">==</span> <span class="token number">1</span> <span class="token comment">% Case of the first triangle</span>
        j_beg <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token comment">% Case of any triangle but not the first</span>
        j_beg <span class="token operator">=</span> nxi <span class="token punctuation">;</span>
    <span class="token keyword">end</span>
    <span class="token keyword">for</span> <span class="token number">j</span> <span class="token operator">=</span> j_beg <span class="token operator">:</span> n<span class="token operator">-</span><span class="token number">1</span>
        Phi <span class="token operator">=</span> Phi <span class="token operator">+</span> PC<span class="token punctuation">.</span><span class="token function">bn</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">fy</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">j</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
    <span class="token keyword">end</span>

    St <span class="token operator">=</span> <span class="token function">StartingTerm</span><span class="token punctuation">(</span><span class="token function">t</span><span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Probl<span class="token punctuation">.</span>ic<span class="token punctuation">)</span> <span class="token punctuation">;</span>
    y_pred <span class="token operator">=</span> St <span class="token operator">+</span> PC<span class="token punctuation">.</span>halpha1<span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">zn_pred</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> Phi<span class="token punctuation">)</span> <span class="token punctuation">;</span>
    f_pred <span class="token operator">=</span> <span class="token function">f_vectorfield</span><span class="token punctuation">(</span><span class="token function">t</span><span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>y_pred<span class="token punctuation">,</span>Probl<span class="token punctuation">)</span> <span class="token punctuation">;</span>

    <span class="token keyword">if</span> PC<span class="token punctuation">.</span>mu <span class="token operator">==</span> <span class="token number">0</span>
        <span class="token function">y</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> y_pred <span class="token punctuation">;</span>
        <span class="token function">fy</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> f_pred <span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        j_beg <span class="token operator">=</span> nxi <span class="token punctuation">;</span>
        Phi <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>Probl<span class="token punctuation">.</span>problem_size<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token number">j</span> <span class="token operator">=</span> j_beg <span class="token operator">:</span> n<span class="token operator">-</span><span class="token number">1</span>
            Phi <span class="token operator">=</span> Phi <span class="token operator">+</span> PC<span class="token punctuation">.</span><span class="token function">an</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">j</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">fy</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">j</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
        <span class="token keyword">end</span>
        Phi_n <span class="token operator">=</span> St <span class="token operator">+</span> PC<span class="token punctuation">.</span>halpha2<span class="token operator">*</span><span class="token punctuation">(</span>PC<span class="token punctuation">.</span><span class="token function">a0</span><span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">fy</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">zn_corr</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> Phi<span class="token punctuation">)</span> <span class="token punctuation">;</span>
        yn0 <span class="token operator">=</span> y_pred <span class="token punctuation">;</span> fn0 <span class="token operator">=</span> f_pred <span class="token punctuation">;</span>
        stop <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> mu_it <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token operator">~</span>stop
            yn1 <span class="token operator">=</span> Phi_n <span class="token operator">+</span> PC<span class="token punctuation">.</span>halpha2<span class="token operator">*</span>fn0 <span class="token punctuation">;</span>
            mu_it <span class="token operator">=</span> mu_it <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">;</span>
            <span class="token keyword">if</span> PC<span class="token punctuation">.</span>mu <span class="token operator">==</span> Inf
                stop <span class="token operator">=</span> <span class="token function">norm</span><span class="token punctuation">(</span>yn1<span class="token operator">-</span>yn0<span class="token punctuation">,</span><span class="token keyword">inf</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> PC<span class="token punctuation">.</span>mu_tol <span class="token punctuation">;</span>
                <span class="token keyword">if</span> mu_it <span class="token operator">&gt;</span> <span class="token number">100</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">~</span>stop
                    <span class="token function">warning</span><span class="token punctuation">(</span><span class="token string">'MATLAB:fde12:NonConvegence'</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
                        <span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'It has been requested to run corrector iterations until convergence but '</span><span class="token punctuation">,</span> <span class="token punctuation">...</span>
                        <span class="token string">'the process does not converge to the tolerance %e in 100 iteration'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>PC<span class="token punctuation">.</span>mu_tol<span class="token punctuation">)</span> <span class="token punctuation">;</span>
                    stop <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">;</span>
                <span class="token keyword">end</span>
            <span class="token keyword">else</span>
                stop <span class="token operator">=</span> mu_it <span class="token operator">==</span> PC<span class="token punctuation">.</span>mu <span class="token punctuation">;</span>
            <span class="token keyword">end</span>
            fn1 <span class="token operator">=</span> <span class="token function">f_vectorfield</span><span class="token punctuation">(</span><span class="token function">t</span><span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>yn1<span class="token punctuation">,</span>Probl<span class="token punctuation">)</span> <span class="token punctuation">;</span>
            yn0 <span class="token operator">=</span> yn1 <span class="token punctuation">;</span> fn0 <span class="token operator">=</span> fn1 <span class="token punctuation">;</span>
        <span class="token keyword">end</span>
        <span class="token function">y</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> yn1 <span class="token punctuation">;</span>
        <span class="token function">fy</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> fn1 <span class="token punctuation">;</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token keyword">end</span>


<span class="token comment">% =========================================================================</span>
<span class="token comment">% =========================================================================</span>
<span class="token keyword">function</span> z <span class="token operator">=</span> <span class="token function">FastConv</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>

r <span class="token operator">=</span> <span class="token function">length</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token punctuation">;</span> problem_size <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>

z <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>problem_size<span class="token punctuation">,</span>r<span class="token punctuation">)</span> <span class="token punctuation">;</span>
X <span class="token operator">=</span> <span class="token function">fft</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>r<span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token number">i</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">:</span> problem_size
    Y <span class="token operator">=</span> <span class="token function">fft</span><span class="token punctuation">(</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span>r<span class="token punctuation">)</span> <span class="token punctuation">;</span>
    Z <span class="token operator">=</span> X<span class="token operator">.*</span>Y <span class="token punctuation">;</span>
    <span class="token function">z</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">ifft</span><span class="token punctuation">(</span>Z<span class="token punctuation">,</span>r<span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token keyword">end</span>

<span class="token keyword">end</span>


<span class="token comment">% =========================================================================</span>
<span class="token comment">% =========================================================================</span>
<span class="token keyword">function</span> f <span class="token operator">=</span> <span class="token function">f_vectorfield</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span>y<span class="token punctuation">,</span>Probl<span class="token punctuation">)</span>

<span class="token keyword">if</span> <span class="token function">isempty</span><span class="token punctuation">(</span>Probl<span class="token punctuation">.</span>param<span class="token punctuation">)</span>
    f <span class="token operator">=</span> <span class="token function">feval</span><span class="token punctuation">(</span>Probl<span class="token punctuation">.</span>fdefun<span class="token punctuation">,</span>t<span class="token punctuation">,</span>y<span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token keyword">else</span>
    f <span class="token operator">=</span> <span class="token function">feval</span><span class="token punctuation">(</span>Probl<span class="token punctuation">.</span>fdefun<span class="token punctuation">,</span>t<span class="token punctuation">,</span>y<span class="token punctuation">,</span>Probl<span class="token punctuation">.</span>param<span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token keyword">end</span>

<span class="token keyword">end</span>


<span class="token comment">% =========================================================================</span>
<span class="token comment">% =========================================================================</span>
<span class="token keyword">function</span> ys <span class="token operator">=</span> <span class="token function">StartingTerm</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span>ic<span class="token punctuation">)</span>

ys <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>ic<span class="token punctuation">.</span>y0<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token keyword">for</span> k <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">:</span> ic<span class="token punctuation">.</span>m_alpha
    ys <span class="token operator">=</span> ys <span class="token operator">+</span> <span class="token punctuation">(</span>t<span class="token operator">-</span>ic<span class="token punctuation">.</span>t0<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>k<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span>ic<span class="token punctuation">.</span><span class="token function">m_alpha_factorial</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">*</span>ic<span class="token punctuation">.</span><span class="token function">y0</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span>k<span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token keyword">end</span>

<span class="token keyword">end</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><pre class="language-matlab" tabindex="0"><code class="language-matlab is-loaded"><span class="token keyword">function</span> f<span class="token operator">=</span><span class="token function">LE_RF</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token punctuation">,</span>x<span class="token punctuation">)</span>
<span class="token comment">%Output data must be a column vector</span>
f<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">%variables allocated to the variational equations</span>
X<span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">x</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">x</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">%RF equations</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">+</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.1</span><span class="token operator">*</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">-</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.1</span><span class="token operator">*</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0.98</span><span class="token operator">+</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">%Jacobian matrix</span>
J<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">-</span><span class="token number">3</span><span class="token operator">*</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">3</span><span class="token operator">*</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">*</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.98</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">%Righthand side of variational equations</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">:</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token operator">=</span>J<span class="token operator">*</span>X<span class="token punctuation">;</span>
<span class="token keyword">end</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><pre class="language-matlab" tabindex="0"><code class="language-matlab is-loaded"><span class="token keyword">function</span> <span class="token punctuation">[</span>t<span class="token punctuation">,</span>LE<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">FO_Lyapunov</span><span class="token punctuation">(</span>ne<span class="token punctuation">,</span>ext_fcn<span class="token punctuation">,</span>t_start<span class="token punctuation">,</span>h_norm<span class="token punctuation">,</span>t_end<span class="token punctuation">,</span>x_start<span class="token punctuation">,</span>h<span class="token punctuation">,</span>q<span class="token punctuation">,</span>out<span class="token punctuation">)</span>
ne<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>
ext_fcn<span class="token operator">=</span><span class="token operator">@</span>LE_RF<span class="token punctuation">;</span>
t_start<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
h_norm<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">;</span>
t_end<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span>
x_start<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">;</span><span class="token number">0.1</span><span class="token punctuation">;</span><span class="token number">0.1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
h<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">;</span>
q<span class="token operator">=</span><span class="token number">0.75</span><span class="token punctuation">;</span>
out<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>

<span class="token comment">% [t,LE]=FO_Lyapunov(3,@LE_RF,0,0.02,300,[0.1;0.1;0.1],0.02,0.98,1000);</span>
%
<span class="token comment">% Program to compute LEs as function of time (t) of autonomous systems of commensurate Fractional Order (FO)</span>
<span class="token comment">% defined via Caputo's derivative;</span>
%
<span class="token comment">% ***********************************************************************************************</span>
<span class="token comment">% August 2022: Improved to overcome the problem of plot function of the last</span>
<span class="token comment">% variants of Matlab</span>
<span class="token comment">% ***********************************************************************************************</span>
%
<span class="token comment">% author: Marius-F. Danca, 2018</span>
<span class="token comment">% http://danca.rist.ro/</span>
<span class="token comment">% email: danca@rist.ro</span>
<span class="token comment">% The program uses a fast variant of the predictor-corrector Adams-Bashforth-Moulton,</span>
<span class="token comment">% FDE12.m for FDEs, by Roberto Garrappa: https://goo.gl/XScYmi</span>
<span class="token comment">% m-files required: FDE12, FO_Lyapunov.m and the function containing the extended system</span>
<span class="token comment">% (see e.g. LE_RF.m).</span>
<span class="token comment">% FO_Lyapunov.m, FDE12.m and LE_FO_RF.m must be in the same folder.</span>
<span class="token comment">% FO_Lyapunov.m was developed, by modifying the program Lyapunov.m, by V.N. Govorukhin:</span>
<span class="token comment">% https://goo.gl/wZVCtg</span>
%
<span class="token comment">% How to use it:</span>
<span class="token comment">% [t,LE]=FO_Lyapunov(ne,ext_fcn,t_start,h_norm,t_end,x_start,h,q,out);</span>
%
<span class="token comment">% Input:</span>
<span class="token comment">% ne - system dimension (eqs number);</span>
<span class="token comment">% ext_fcn - function containing the extended system of FO;</span>
<span class="token comment">% t_start, t_end - time span (FDE12);</span>
<span class="token comment">% h - integration step;</span>
<span class="token comment">% h_norm - step for Gram-Schmidt renormalization (Lyapunov algorithm), an important parameter:</span>
<span class="token comment">%       experimentaly determined as an optimal choice if it is multiple of h, or equal;</span>
<span class="token comment">% x_start - initial condition;</span>
<span class="token comment">% q - the fractional order;</span>
<span class="token comment">% out - priniting step of LEs values;</span>
<span class="token comment">% out==0 - no print.</span>
%
<span class="token comment">% Output:</span>
<span class="token comment">% t - time values;</span>
<span class="token comment">% LE Lyapunov exponents to each time value printed every 'out' step.</span>
%
<span class="token comment">% Example of use for the RF system:</span>
<span class="token comment">% [t,LE]=FO_Lyapunov(3,@LE_RF,0,0.02,300,[0.1;0.1;0.1],0.02,0.98,1000);</span>
%
<span class="token comment">% Cite as:</span>
%
<span class="token comment">% Marius-F. Danca and N. Kuznetsov, Matlab code for Lyapunov exponents of</span>
<span class="token comment">% fractional order systems, International Journal of Bifurcation and Chaos,</span>
<span class="token comment">% 28(05)(2018), 1850067</span>
%
<span class="token comment">% see also:</span>
<span class="token comment">% Marius.-F. Danca, Matlab code for Lyapunov exponents of fractional-order systems,</span>
<span class="token comment">% Part II: The non-commensurate case, International Journal of Bifurcation and Chaos,</span>
<span class="token comment">% 31(12), 2150187, (2021)</span>
%
hold on<span class="token punctuation">;</span>
colors <span class="token operator">=</span> <span class="token string">'grby'</span><span class="token punctuation">;</span><span class="token comment">%can be expanded expand that to include any of the 8 color codes bcgkmrwy</span>
<span class="token comment">% Memory allocation</span>
x<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>ne<span class="token operator">*</span><span class="token punctuation">(</span>ne<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
x0<span class="token operator">=</span>x<span class="token punctuation">;</span>
c<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>ne<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
gsc<span class="token operator">=</span>c<span class="token punctuation">;</span> zn<span class="token operator">=</span>c<span class="token punctuation">;</span>
n_it <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span>t_end<span class="token operator">-</span>t_start<span class="token punctuation">)</span><span class="token operator">/</span>h_norm<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">% Initial values</span>
    <span class="token function">x</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span>ne<span class="token punctuation">)</span><span class="token operator">=</span>x_start<span class="token punctuation">;</span>
    <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token number">i</span><span class="token operator">&lt;=</span>ne
        <span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ne<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">;</span>
        <span class="token number">i</span><span class="token operator">=</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span>
    t<span class="token operator">=</span>t_start<span class="token punctuation">;</span>
<span class="token comment">% Main loop</span>
it<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> it<span class="token operator">&lt;=</span>n_it
        LE<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>ne<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">% Solutuion of extended ODE system of FO using FDE12 routine</span>
        <span class="token punctuation">[</span><span class="token operator">~</span><span class="token punctuation">,</span>Y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">fde12</span><span class="token punctuation">(</span>q<span class="token punctuation">,</span>ext_fcn<span class="token punctuation">,</span>t<span class="token punctuation">,</span>t<span class="token operator">+</span>h_norm<span class="token punctuation">,</span>x<span class="token punctuation">,</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>
        t<span class="token operator">=</span>t<span class="token operator">+</span>h_norm<span class="token punctuation">;</span>
        Y<span class="token operator">=</span><span class="token function">transpose</span><span class="token punctuation">(</span>Y<span class="token punctuation">)</span><span class="token punctuation">;</span>
        x<span class="token operator">=</span><span class="token function">Y</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>Y<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%solution at t+h_norm</span>
        <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token number">i</span><span class="token operator">&lt;=</span>ne
            <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token number">j</span><span class="token operator">&lt;=</span>ne
                <span class="token function">x0</span><span class="token punctuation">(</span>ne<span class="token operator">*</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">x</span><span class="token punctuation">(</span>ne<span class="token operator">*</span><span class="token number">j</span><span class="token operator">+</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token number">j</span><span class="token operator">=</span><span class="token number">j</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>
            <span class="token number">i</span><span class="token operator">=</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
<span class="token comment">%       construct new orthonormal basis by gram-schmidt</span>
        <span class="token function">zn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">;</span>
        <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token number">j</span><span class="token operator">&lt;=</span>ne
            <span class="token function">zn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">zn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">x0</span><span class="token punctuation">(</span>ne<span class="token operator">*</span><span class="token number">j</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token number">j</span><span class="token operator">=</span><span class="token number">j</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
        <span class="token function">zn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token function">zn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token number">j</span><span class="token operator">&lt;=</span>ne
            <span class="token function">x0</span><span class="token punctuation">(</span>ne<span class="token operator">*</span><span class="token number">j</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">x0</span><span class="token punctuation">(</span>ne<span class="token operator">*</span><span class="token number">j</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">zn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token number">j</span><span class="token operator">=</span><span class="token number">j</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
        <span class="token number">j</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token number">j</span><span class="token operator">&lt;=</span>ne
            k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> k<span class="token operator">&lt;=</span><span class="token number">j</span><span class="token operator">-</span><span class="token number">1</span>
                <span class="token function">gsc</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">;</span>
                l<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token keyword">while</span> l<span class="token operator">&lt;=</span>ne
                    <span class="token function">gsc</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">gsc</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">x0</span><span class="token punctuation">(</span>ne<span class="token operator">*</span>l<span class="token operator">+</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">x0</span><span class="token punctuation">(</span>ne<span class="token operator">*</span>l<span class="token operator">+</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    l<span class="token operator">=</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token keyword">end</span>
                k<span class="token operator">=</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>
            k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> k<span class="token operator">&lt;=</span>ne
                l<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token keyword">while</span> l<span class="token operator">&lt;=</span><span class="token number">j</span><span class="token operator">-</span><span class="token number">1</span>
                    <span class="token function">x0</span><span class="token punctuation">(</span>ne<span class="token operator">*</span>k<span class="token operator">+</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">x0</span><span class="token punctuation">(</span>ne<span class="token operator">*</span>k<span class="token operator">+</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">gsc</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">x0</span><span class="token punctuation">(</span>ne<span class="token operator">*</span>k<span class="token operator">+</span>l<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    l<span class="token operator">=</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token keyword">end</span>
                k<span class="token operator">=</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>
            <span class="token function">zn</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">;</span>
            k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> k<span class="token operator">&lt;=</span>ne
                <span class="token function">zn</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">zn</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">x0</span><span class="token punctuation">(</span>ne<span class="token operator">*</span>k<span class="token operator">+</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">;</span>
                k<span class="token operator">=</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>
            <span class="token function">zn</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token function">zn</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> k<span class="token operator">&lt;=</span>ne
                <span class="token function">x0</span><span class="token punctuation">(</span>ne<span class="token operator">*</span>k<span class="token operator">+</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">x0</span><span class="token punctuation">(</span>ne<span class="token operator">*</span>k<span class="token operator">+</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">zn</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                k<span class="token operator">=</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>
            <span class="token number">j</span><span class="token operator">=</span><span class="token number">j</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
<span class="token comment">%       update running vector magnitudes</span>
        k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> k<span class="token operator">&lt;=</span>ne
            <span class="token function">c</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">c</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">zn</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            k<span class="token operator">=</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
<span class="token comment">%       normalize exponent</span>
        k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> k<span class="token operator">&lt;=</span>ne
            <span class="token function">LE</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">c</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>t<span class="token operator">-</span>t_start<span class="token punctuation">)</span><span class="token punctuation">;</span>
            k<span class="token operator">=</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
<span class="token comment">%       print results</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mod</span><span class="token punctuation">(</span>it<span class="token punctuation">,</span>out<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'%10.2f %10.4f %10.4f %10.4f\n'</span><span class="token punctuation">,</span><span class="token punctuation">[</span>t<span class="token punctuation">,</span>LE<span class="token operator">'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
        <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token number">i</span><span class="token operator">&lt;=</span>ne
            <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token number">j</span><span class="token operator">&lt;=</span>ne
                <span class="token function">x</span><span class="token punctuation">(</span>ne<span class="token operator">*</span><span class="token number">j</span><span class="token operator">+</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">x0</span><span class="token punctuation">(</span>ne<span class="token operator">*</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token number">j</span><span class="token operator">=</span><span class="token number">j</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>
            <span class="token number">i</span><span class="token operator">=</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
        x<span class="token operator">=</span><span class="token function">transpose</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
        it<span class="token operator">=</span>it<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token comment">%       display LEs</span>
    <span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>ne
        <span class="token function">plot</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span><span class="token function">LE</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'.'</span><span class="token punctuation">,</span><span class="token string">'Color'</span><span class="token punctuation">,</span><span class="token function">colors</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">%plot(t,LE(i),'.','markersize',1,'Color',colors(i));%for thiny draw</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'t'</span><span class="token punctuation">,</span><span class="token string">'fontsize'</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'LEs'</span><span class="token punctuation">,</span><span class="token string">'fontsize'</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">)</span>
<span class="token function">set</span><span class="token punctuation">(</span>gca<span class="token punctuation">,</span><span class="token string">'fontsize'</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">)</span>
box on<span class="token punctuation">;</span>
<span class="token function">line</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span>t<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'color'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">)</span>
axis tight
</code><button class="copy-code-button">Copy</button></pre></div><div class="mod-footer"></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-gutter"><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-container"><div class="sidebar-sizer"><div class="sidebar-content-positioner"><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder"><div class="graph-view-container"><div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div><canvas id="graph-canvas" width="512px" height="512px"></canvas></div></div></div><div class="tree-container outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button is-collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area"></div></div></div></div></div></div></div></div></body></html>